<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dynamic JW Player</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #jwplayerDiv {
            width: 80%;
            max-width: 1280px;
            aspect-ratio: 16 / 9;
            background: #000;
        }
    </style>
    <script src="//content.jwplatform.com/libraries/SAHhwvZq.js"></script>
</head>
<body>
    <div id="jwplayerDiv"></div>

    <script>
        // دالة لاستخراج المعلمات من رابط الصفحة
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                manifest: params.get('manifest'),
                drmKey: params.get('drmkey')
            };
        }

        document.addEventListener('DOMContentLoaded', () => {
            const { manifest, drmKey } = getQueryParams();

            if (!manifest || !drmKey) {
                console.error('المعلمات مطلوبة: manifest و drmkey');
                return;
            }

            const [keyId, keyValue] = drmKey.split(':');
            if (!keyId || !keyValue) {
                console.error('صيغة drmkey غير صحيحة. يجب أن تكون على الشكل keyId:keyValue');
                return;
            }

            // إعداد JW Player
            jwplayer("jwplayerDiv").setup({
                file: manifest,
                type: "dash",
                autostart: true,
                drm: {
                    clearkey: {
                        keyId: keyId,
                        key: keyValue
                    }
                },
                width: "100%",
                height: "100%",
                skin: {
                    name: "glow"
                }
            });

            console.log('تم إعداد الفيديو بنجاح');
        });
    </script>
</body>
</html>
